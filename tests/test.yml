---

- name: setup for tests
  hosts: containers
  tags: [always]
  tasks:
    - action: ping

- name: cleanup before test using os package manager
  include: test_cleanup.yml
  tags: [pkg, pkg-cleanup]

- name: test installation using os package manager
  hosts: containers
  gather_facts: false
  tags: [pkg]
  vars:
    uwsgi_vassals:
      - name: test
  roles:
    - role: cchurch.uwsgi

- name: cleanup before test using pip
  include: test_cleanup.yml
  tags: [pip, pip-cleanup]

- name: test installation using pip
  hosts: containers
  gather_facts: false
  tags: [pip]
  vars:
    uwsgi_install: pip
    uwsgi_vassals:
      - name: test
  roles:
    - role: cchurch.uwsgi
